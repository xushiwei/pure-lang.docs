

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pure-sockets: Pure Sockets Interface &mdash; Pure Language and Library Documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.46',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="Pure Language and Library Documentation" href="index.html" />
    <link rel="next" title="Gnumeric/Pure: A Pure Plugin for Gnumeric" href="gnumeric-pure.html" />
    <link rel="prev" title="pure-readline" href="pure-readline.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="gnumeric-pure.html" title="Gnumeric/Pure: A Pure Plugin for Gnumeric"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pure-readline.html" title="pure-readline"
             accesskey="P">previous</a> |</li>
        <li><a href="puredoc.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="pure-sockets-pure-sockets-interface">
<h1>pure-sockets: Pure Sockets Interface<a class="headerlink" href="#pure-sockets-pure-sockets-interface" title="Permalink to this headline">¶</a></h1>
<p>Version 0.1, November 14, 2010</p>
<p>Albert Gräf &lt;<a class="reference external" href="mailto:Dr&#46;Graef&#37;&#52;&#48;t-online&#46;de">Dr<span>&#46;</span>Graef<span>&#64;</span>t-online<span>&#46;</span>de</a>&gt;</p>
<p>This is an interface to the Berkeley socket functions. It provides most of the
core functionality, so you can create sockets for both stream and datagram
based protocols and use these to transmit messages. Unix-style file sockets
are also available if the host system supports them.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Get the latest source from
<a class="reference external" href="http://pure-lang.googlecode.com/files/pure-sockets-0.1.tar.gz">http://pure-lang.googlecode.com/files/pure-sockets-0.1.tar.gz</a>.</p>
<p>This package uses Pure&#8217;s new bitcode loader to ease porting, so you&#8217;ll need
Pure 0.45 or later and an LLVM-based C compiler installed. The Makefile is set
up for clang (<a class="reference external" href="http://clang.llvm.org/">http://clang.llvm.org/</a>) by default, because it&#8217;s easier to
install, but you can also use llvm-gcc if you set the CC make variable
accordingly.</p>
<p>For clang compilation, do the usual <tt class="docutils literal"><span class="pre">make</span> <span class="pre">&amp;&amp;</span> <span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">install</span></tt> and you
should be set. To use llvm-gcc, replace <tt class="docutils literal"><span class="pre">make</span></tt> with <tt class="docutils literal"><span class="pre">make</span> <span class="pre">CC=llvm-gcc</span></tt>.
You can also set custom compilation options with the CFLAGS variable, e.g.:
<tt class="docutils literal"><span class="pre">make</span> <span class="pre">CFLAGS=-O3</span></tt>.</p>
<p>To uninstall the module, use <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">make</span> <span class="pre">uninstall</span></tt>. There are a number of
other targets (mostly for maintainers), please see the Makefile for details.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To use the operations of this module, put the following in your Pure script:</p>
<div class="highlight-pure"><div class="highlight"><pre><span class="kr">using</span> sockets<span class="p">;</span>
</pre></div>
</div>
<p>NOTE: On some systems you may also have to pull in a special system library to
get the socket functions. E.g.:</p>
<div class="highlight-pure"><div class="highlight"><pre><span class="kr">using</span> <span class="s">&quot;lib:wsock32&quot;</span>, sockets<span class="p">;</span>
</pre></div>
</div>
<p>With the <tt class="docutils literal"><span class="pre">sockets</span></tt> module loaded, all the standard socket functions are
available and work pretty much like in C. The only real difference is that,
for convenience, functions taking socket addresses as parameters
(<tt class="docutils literal"><span class="pre">struct_sockaddr*</span></tt> pointers in Pure), are called without the <tt class="docutils literal"><span class="pre">addrlen</span></tt>
parameter; the size of the socket address structure will be inferred
automatically and passed to the underlying C functions. Also, there are some
convenience functions which act as wrappers around <tt class="docutils literal"><span class="pre">getaddrinfo</span></tt> and
<tt class="docutils literal"><span class="pre">getnameinfo</span></tt> to create socket addresses from symbolic information (hostname
or ip, port names or numbers) and return information about existing address
pointers, see <a class="reference internal" href="#creating-and-inspecting-socket-addresses">Creating and Inspecting Socket Addresses</a> below.</p>
<p>Below is a list of the provided functions. Please see the corresponding manual
pages for details, and check the Pure scripts in the examples subdirectory for
some examples.</p>
<div class="section" id="creating-and-inspecting-socket-addresses">
<h3>Creating and Inspecting Socket Addresses<a class="headerlink" href="#creating-and-inspecting-socket-addresses" title="Permalink to this headline">¶</a></h3>
<p>These functions are Pure-specific. The created socket addresses are
<tt class="docutils literal"><span class="pre">malloc</span></tt>&#8216;ed and free themselves automatically when garbage-collected.</p>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddr();</span></tt></p>
<blockquote>
Create a pointer to an empty socket address suitable to hold the socket
address result of routines like <tt class="docutils literal"><span class="pre">accept</span></tt>, <tt class="docutils literal"><span class="pre">getsockname</span></tt>, <tt class="docutils literal"><span class="pre">recvfrom</span></tt>,
etc. which return a socket address.</blockquote>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddr([int</span> <span class="pre">family,]</span> <span class="pre">char</span> <span class="pre">*path);</span></tt></p>
<blockquote>
Create a local (a.k.a. file) socket for the given pathname. The <tt class="docutils literal"><span class="pre">family</span></tt>
parameter, if specified, must be <tt class="docutils literal"><span class="pre">AF_UNIX</span></tt> here. Please note that
<tt class="docutils literal"><span class="pre">AF_UNIX</span></tt> is not supported on all platforms. You can check for this by
testing the <tt class="docutils literal"><span class="pre">HAVE_AF_UNIX</span></tt> constant, which is a truth value specifying
whether <tt class="docutils literal"><span class="pre">AF_UNIX</span></tt> is available on your system.</blockquote>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddr([int</span> <span class="pre">family,]</span> <span class="pre">char</span> <span class="pre">*host,</span> <span class="pre">char</span> <span class="pre">*port);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddr([int</span> <span class="pre">family,]</span> <span class="pre">char</span> <span class="pre">*host,</span> <span class="pre">int</span> <span class="pre">port);</span></tt></p>
<blockquote>
This uses <tt class="docutils literal"><span class="pre">getaddrinfo</span></tt> to retrieve an <tt class="docutils literal"><span class="pre">AF_INET</span></tt> or <tt class="docutils literal"><span class="pre">AF_INET6</span></tt>
address for the given hostname (or numeric IP address in string form) and
port (specified either as an int or a string). If <tt class="docutils literal"><span class="pre">family</span></tt> is omitted,
it defaults to <tt class="docutils literal"><span class="pre">AF_UNSPEC</span></tt> which matches both <tt class="docutils literal"><span class="pre">AF_INET</span></tt> and
<tt class="docutils literal"><span class="pre">AF_INET6</span></tt> addresses.</blockquote>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddrs([int</span> <span class="pre">family,]</span> <span class="pre">char</span> <span class="pre">*host,</span> <span class="pre">char</span> <span class="pre">*port);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">struct_sockaddr</span> <span class="pre">*sockaddrs([int</span> <span class="pre">family,]</span> <span class="pre">char</span> <span class="pre">*host,</span> <span class="pre">int</span> <span class="pre">port);</span></tt></p>
<blockquote>
This works like <tt class="docutils literal"><span class="pre">sockaddr</span></tt> above, but returns a list with <em>all</em> matching
addresses.</blockquote>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">sockaddr_family(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the address family of the given address.</blockquote>
<p><tt class="docutils literal"><span class="pre">char</span> <span class="pre">*sockaddr_path(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the pathname for <tt class="docutils literal"><span class="pre">AF_UNIX</span></tt> addresses.</blockquote>
<p><tt class="docutils literal"><span class="pre">char</span> <span class="pre">*sockaddr_hostname(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the hostname if available, the IP address otherwise.</blockquote>
<p><tt class="docutils literal"><span class="pre">char</span> <span class="pre">*sockaddr_ip(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the IP address.</blockquote>
<p><tt class="docutils literal"><span class="pre">char</span> <span class="pre">*sockaddr_service(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the service (a.k.a. port) name.</blockquote>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">sockaddr_port(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns the port number.</blockquote>
<p><tt class="docutils literal"><span class="pre">expr</span> <span class="pre">*sockaddr_info(struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<blockquote>
Returns a readable description of a socket address, as a
<tt class="docutils literal"><span class="pre">(family,hostname,port)</span></tt> tuple. You should be able to pass this into
<tt class="docutils literal"><span class="pre">sockaddr</span></tt> again to get the original address.</blockquote>
</div>
<div class="section" id="creating-and-closing-sockets">
<h3>Creating and Closing Sockets<a class="headerlink" href="#creating-and-closing-sockets" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">socket(int</span> <span class="pre">domain,</span> <span class="pre">int</span> <span class="pre">type,</span> <span class="pre">int</span> <span class="pre">protocol);</span></tt></p>
<blockquote>
Creates a socket for the given protocol family (<tt class="docutils literal"><span class="pre">AF_UNIX</span></tt>, <tt class="docutils literal"><span class="pre">AF_INET</span></tt>
or <tt class="docutils literal"><span class="pre">AF_INET6</span></tt>), socket type (<tt class="docutils literal"><span class="pre">SOCK_STREAM</span></tt>, <tt class="docutils literal"><span class="pre">SOCK_DGRAM</span></tt>, etc.) and
protocol. Note that on Linux we also support the <tt class="docutils literal"><span class="pre">SOCK_NONBLOCK</span></tt>
(non-blocking) and <tt class="docutils literal"><span class="pre">SOCK_CLOEXEC</span></tt> (close-on-exec) flags which can be
or&#8217;ed with the socket type to get sockets with the corresponding
features. The protocol number is usually 0, denoting the default protocol,
but it can also be any of the prescribed <tt class="docutils literal"><span class="pre">IPPROTO</span></tt> constants (a few
common ones are predefined by this module, try <tt class="docutils literal"><span class="pre">show</span> <span class="pre">-g</span> <span class="pre">IPPROTO_*</span></tt> for a
list of those).</blockquote>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">socketpair(int</span> <span class="pre">domain,</span> <span class="pre">int</span> <span class="pre">type,</span> <span class="pre">int</span> <span class="pre">protocol,</span> <span class="pre">int</span> <span class="pre">*sv);</span></tt></p>
<blockquote>
Create a pair of sockets. The descriptors are returned in the integer
vector passed in the last argument.</blockquote>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">shutdown(int</span> <span class="pre">fd,</span> <span class="pre">int</span> <span class="pre">how);</span></tt></p>
<blockquote>
Perform shutdown on a socket. The second argument should be one of
<tt class="docutils literal"><span class="pre">SHUT_RD</span></tt>, <tt class="docutils literal"><span class="pre">SHUT_WR</span></tt> and <tt class="docutils literal"><span class="pre">SHUT_RDWR</span></tt>.</blockquote>
<p><tt class="docutils literal"><span class="pre">closesocket(int</span> <span class="pre">fd);</span></tt></p>
<blockquote>
This is provided for Windows compatibility. On POSIX systems this is just
<tt class="docutils literal"><span class="pre">close</span></tt>.</blockquote>
</div>
<div class="section" id="establishing-connections">
<h3>Establishing Connections<a class="headerlink" href="#establishing-connections" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">accept(int</span> <span class="pre">sockfd,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">bind(int</span> <span class="pre">sockfd,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">connect(int</span> <span class="pre">sockfd,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">listen(int</span> <span class="pre">sockfd,</span> <span class="pre">int</span> <span class="pre">backlog);</span></tt></p>
</div>
<div class="section" id="socket-i-o">
<h3>Socket I/O<a class="headerlink" href="#socket-i-o" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">size_t</span> <span class="pre">recv(int</span> <span class="pre">fd,</span> <span class="pre">void</span> <span class="pre">*buf,</span> <span class="pre">size_t</span> <span class="pre">len,</span> <span class="pre">int</span> <span class="pre">flags);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">size_t</span> <span class="pre">send(int</span> <span class="pre">fd,</span> <span class="pre">void</span> <span class="pre">*buf,</span> <span class="pre">size_t</span> <span class="pre">len,</span> <span class="pre">int</span> <span class="pre">flags);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">size_t</span> <span class="pre">recvfrom(int</span> <span class="pre">fd,</span> <span class="pre">void</span> <span class="pre">*buf,</span> <span class="pre">size_t</span> <span class="pre">len,</span> <span class="pre">int</span> <span class="pre">flags,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">size_t</span> <span class="pre">sendto(int</span> <span class="pre">fd,</span> <span class="pre">void</span> <span class="pre">*buf,</span> <span class="pre">size_t</span> <span class="pre">len,</span> <span class="pre">int</span> <span class="pre">flags,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p>The usual <tt class="docutils literal"><span class="pre">send</span></tt>/<tt class="docutils literal"><span class="pre">recv</span></tt> flags specified by POSIX (<tt class="docutils literal"><span class="pre">MSG_EOR</span></tt>,
<tt class="docutils literal"><span class="pre">MSG_OOB</span></tt>, <tt class="docutils literal"><span class="pre">MSG_PEEK</span></tt>, <tt class="docutils literal"><span class="pre">MSG_WAITALL</span></tt>) are provided. On Linux we also
support <tt class="docutils literal"><span class="pre">MSG_DONTWAIT</span></tt>. Note that on POSIX systems you can also just
<tt class="docutils literal"><span class="pre">fdopen</span></tt> the socket descriptor and use the standard file I/O operations from
the <tt class="docutils literal"><span class="pre">system</span></tt> module instead.</p>
</div>
<div class="section" id="socket-information">
<h3>Socket Information<a class="headerlink" href="#socket-information" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">getsockname(int</span> <span class="pre">fd,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">getpeername(int</span> <span class="pre">fd,</span> <span class="pre">struct_sockaddr</span> <span class="pre">*addr);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">getsockopt(int</span> <span class="pre">fd,</span> <span class="pre">int</span> <span class="pre">level,</span> <span class="pre">int</span> <span class="pre">name,</span> <span class="pre">void</span> <span class="pre">*val,</span> <span class="pre">int</span> <span class="pre">*len);</span></tt></p>
<p><tt class="docutils literal"><span class="pre">int</span> <span class="pre">setsockopt(int</span> <span class="pre">fd,</span> <span class="pre">int</span> <span class="pre">level,</span> <span class="pre">int</span> <span class="pre">name,</span> <span class="pre">void</span> <span class="pre">*val,</span> <span class="pre">int</span> <span class="pre">len);</span></tt></p>
<p>For <tt class="docutils literal"><span class="pre">getsockopt</span></tt> and <tt class="docutils literal"><span class="pre">setsockopt</span></tt>, currently only the <tt class="docutils literal"><span class="pre">SOL_SOCKET</span></tt> level
is defined (<tt class="docutils literal"><span class="pre">level</span></tt> argument) along with the available POSIX socket options
(<tt class="docutils literal"><span class="pre">name</span></tt> argument). Try <tt class="docutils literal"><span class="pre">show</span> <span class="pre">-g</span> <span class="pre">SO_*</span></tt> to get a list of those. Also note
that for most socket level options the <tt class="docutils literal"><span class="pre">val</span></tt> argument is actually an
<tt class="docutils literal"><span class="pre">int*</span></tt>, so you can pass a Pure int vector (with <tt class="docutils literal"><span class="pre">len</span> <span class="pre">=</span> <span class="pre">SIZEOF_INT</span></tt>) for
that parameter.</p>
</div>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Here is a fairly minimal example using Unix stream sockets. To keep things
simple, this does no error checking whatsoever and just keeps sending strings
back and forth. More elaborate examples can be found in the examples directory
in the sources.</p>
<div class="highlight-pure"><div class="highlight"><pre><span class="kr">using</span> sockets, system<span class="p">;</span>

<span class="kr">const</span> path = <span class="s">&quot;server_socket&quot;</span><span class="p">;</span>
<span class="kr">extern</span> <span class="kt">int</span> unlink(<span class="kt">char</span> *name)<span class="p">;</span>

server = loop <span class="kr">with</span>
  loop = loop <span class="kr">if</span> ~null s &amp;&amp; ~response fp s <span class="kr">when</span>
    <span class="c1">// Connect to a client.</span>
    cfd = accept fd $ sockaddr ()<span class="p">;</span>
    <span class="c1">// Open the client socket as a FILE* and read a request.</span>
    fp = fdopen cfd <span class="s">&quot;r+&quot;</span><span class="p">;</span> s = fgets fp<span class="p">;</span>
  <span class="kr">end</span><span class="p">;</span>
  loop = puts <span class="s">&quot;server is exiting&quot;</span> $$ closesocket fd $$
         unlink path $$ () <span class="kr">otherwise</span><span class="p">;</span>
  response fp s<span class="p">::</span><span class="kt">string</span> = s==<span class="s">&quot;quit</span><span class="se">\n</span><span class="s">&quot;</span> <span class="kr">when</span>
    <span class="c1">// Process the request. (Here we just print the received</span>
    <span class="c1">// message and echo it back to the client.)</span>
    printf <span class="s">&quot;server&gt; %s&quot;</span> s<span class="p">;</span>
    fputs s fp<span class="p">;</span>
  <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span> <span class="kr">when</span>
  <span class="c1">// Create the server socket and start listening.</span>
  unlink path<span class="p">;</span>
  fd = socket AF_UNIX SOCK_STREAM <span class="mi">0</span><span class="p">;</span>
  bind fd (sockaddr path)<span class="p">;</span> listen fd <span class="mi">5</span><span class="p">;</span>
  printf <span class="s">&quot;server listening at &#39;%s&#39;</span><span class="se">\n</span><span class="s">&quot;</span> path<span class="p">;</span>
<span class="kr">end</span><span class="p">;</span>

client = loop <span class="kr">with</span>
  <span class="c1">// Keep reading requests from stdin.</span>
  loop = loop <span class="kr">if</span> ~null s &amp;&amp; ~request s <span class="kr">when</span>
    fputs <span class="s">&quot;client&gt; &quot;</span> stdout<span class="p">;</span> s = fgets stdin<span class="p">;</span>
  <span class="kr">end</span><span class="p">;</span>
  loop = puts <span class="s">&quot;client is exiting&quot;</span> $$ () <span class="kr">otherwise</span><span class="p">;</span>
  request s<span class="p">::</span><span class="kt">string</span> = s==<span class="s">&quot;quit</span><span class="se">\n</span><span class="s">&quot;</span> <span class="kr">when</span>
    fd = socket AF_UNIX SOCK_STREAM <span class="mi">0</span><span class="p">;</span>
    connect fd (sockaddr path)<span class="p">;</span>
    <span class="c1">// Send the request to the server.</span>
    fp = fdopen fd <span class="s">&quot;r+&quot;</span><span class="p">;</span> fputs s fp<span class="p">;</span>
    <span class="c1">// Get the reply.</span>
    s = fgets fp<span class="p">;</span>
  <span class="kr">end</span><span class="p">;</span>
<span class="kr">end</span><span class="p">;</span>
</pre></div>
</div>
<p>To use this example, run the <tt class="docutils literal"><span class="pre">server</span></tt> function in one instance of the Pure
interpreter and the <tt class="docutils literal"><span class="pre">client</span></tt> function in another. Enter a line when the
client prompts you for input; it will be printed by the server. Behind the
scenes, the server also sends the line back to the client. After receiving the
reply, the client prompts for the next input line. Entering end-of-file at the
client prompt terminates the client but keeps the server running, so that you
can start another client and reconnect to the server. Entering just <tt class="docutils literal"><span class="pre">quit</span></tt>
in the client terminates both server and client. Here is how a typical
interaction may look like:</p>
<div class="highlight-pure"><div class="highlight"><pre><span class="gp">&gt; </span>client<span class="p">;</span>
client&gt; <span class="mi">1</span>+<span class="mi">1</span>
client&gt; foo bar
client&gt; quit
client is exiting
()

<span class="gp">&gt; </span>server<span class="p">;</span>
server listening at &#39;server_socket&#39;
server&gt; <span class="mi">1</span>+<span class="mi">1</span>
server&gt; foo bar
server&gt; quit
server is exiting
()
</pre></div>
</div>
<p>Note that while the server processes requests sequentially, it accepts
connections from a new client after each request, so that you can run as many
clients as you like.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="puredoc.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">pure-sockets: Pure Sockets Interface</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#creating-and-inspecting-socket-addresses">Creating and Inspecting Socket Addresses</a></li>
<li><a class="reference internal" href="#creating-and-closing-sockets">Creating and Closing Sockets</a></li>
<li><a class="reference internal" href="#establishing-connections">Establishing Connections</a></li>
<li><a class="reference internal" href="#socket-i-o">Socket I/O</a></li>
<li><a class="reference internal" href="#socket-information">Socket Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pure-readline.html"
                        title="previous chapter">pure-readline</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="gnumeric-pure.html"
                        title="next chapter">Gnumeric/Pure: A Pure Plugin for Gnumeric</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/pure-sockets.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="gnumeric-pure.html" title="Gnumeric/Pure: A Pure Plugin for Gnumeric"
             >next</a> |</li>
        <li class="right" >
          <a href="pure-readline.html" title="pure-readline"
             >previous</a> |</li>
        <li><a href="puredoc.html">Pure Language and Library Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2010, Albert Gräf et al.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1pre.
    </div>
  </body>
</html>